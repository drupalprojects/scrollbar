<?php

/**
 * @file
 * Scrollbar module help, settings and configuration menu
 */

use Drupal\Core\Routing\RouteMatchInterface;


/**
 * Implements hook_help().
 *
 * @param $route_name
 * @param \Drupal\Core\Routing\RouteMatchInterface $route_match
 * @return string
 */
function scrollbar_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    case 'help.page.scrollbar':
      
      $output = '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('This module allows for integration of the jScrollpane jQuery plugin into Drupal.</br>') . '</p>';
      $output .= '<h3>' . t('Configuration') . '</h3>';
      $output .= '<p>' . t('Go to "Configuration" -> "User Interface" -> "Scrollbar" to find all the configuration options.') . '</p>';
      $output .= '<h3>' . t('Settings') . '</h3>';
      $output .= '<p>' . t('See more details about jScrollPane configuration at the official documentation at <a href="@plugin_url">jScrollPane homepage</a>.',
          [
            "@plugin_url" => "http://jscrollpane.kelvinluck.com/index.html#examples",
          ]
        );
      
      return $output;
  }
}

/**
 * Implements hook_page_attachments().
 * @param $page
 */
function scrollbar_page_attachments(&$page) {
  $settings = [];
  $config = \Drupal::config('scrollbar.settings');
  
  if ($config->get('enable')) {
    $settings['element'] = $config->get('element');
    $settings['showArrows'] = $config->get('showArrows');
    $settings['maintainPosition'] = $config->get('maintainPosition');
    $settings['stickToBottom'] = $config->get('stickToBottom');
    $settings['stickToRight'] = $config->get('stickToRight');
    $settings['contentWidth'] = $config->get('contentWidth');
    $settings['animateScroll'] = $config->get('animateScroll');
    $settings['animateDuration'] = $config->get('animateDuration');
    $settings['animateEase'] = $config->get('animateEase');
    $settings['hijackInternalLinks'] = $config->get('hijackInternalLinks');
    $settings['enableKeyboardNavigation'] = $config->get('enableKeyboardNavigation');
    $settings['hideFocus'] = $config->get('hideFocus');
    $settings['clickOnTrack'] = $config->get('clickOnTrack');
    $settings['trackClickSpeed'] = $config->get('trackClickSpeed');
    $settings['trackClickRepeatFreq'] = $config->get('trackClickRepeatFreq');

    $settings['mouseWheelSpeed'] = $config->get('mouseWheelSpeed');
    $settings['arrowButtonSpeed'] = $config->get('arrowButtonSpeed');
    $settings['arrowRepeatFreq'] = $config->get('arrowRepeatFreq');
    $settings['horizontalGutter'] = $config->get('horizontalGutter');
    $settings['verticalGutter'] = $config->get('verticalGutter');
    $settings['verticalDragMinHeight'] = $config->get('verticalDragMinHeight');
    $settings['verticalDragMaxHeight'] = $config->get('verticalDragMaxHeight');
    $settings['verticalDragMinWidth'] = $config->get('verticalDragMinWidth');
    $settings['verticalDragMaxWidth'] = $config->get('verticalDragMaxWidth');
    $settings['horizontalDragMinHeight'] = $config->get('horizontalDragMinHeight');
    $settings['horizontalDragMaxHeight'] = $config->get('horizontalDragMaxHeight');
    $settings['horizontalDragMinWidth'] = $config->get('horizontalDragMinWidth');
    $settings['horizontalDragMaxWidth'] = $config->get('horizontalDragMaxWidth');
    $settings['arrowScrollOnHover'] = $config->get('arrowScrollOnHover');
    $settings['verticalArrowPositions'] = $config->get('verticalArrowPositions');
    $settings['horizontalArrowPositions'] = $config->get('horizontalArrowPositions');
    $settings['autoReinitialise'] = $config->get('autoReinitialise');
    $settings['autoReinitialiseDelay'] = $config->get('autoReinitialiseDelay');

    $page['#attached']['drupalSettings']['scrollbar'] = $settings;
    $page['#attached']['library'][] = 'scrollbar/jscrollpane';
    $page['#attached']['library'][] = 'scrollbar/scrollbar';
  }
}